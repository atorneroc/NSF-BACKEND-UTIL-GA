name: "Backend CI/CD (.NET 8)"

on:
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]

permissions:
  id-token: write
  contents: read
  actions: read
  security-events: write








  # -------------------------------
  # ðŸš€ Despliegue 2: App Service por Contenedor
  # -------------------------------
  deploy-container:
    if: ${{ github.event_name == 'push' }}
    uses: ./.github/workflows/deploy-azure-container.yml
    with:
      app_name: "nsf-backend-ga-cont"          # ðŸ‘ˆ tu App Service basado en ACR
      acr_name: "nsfacrdev"
      image_name: "nsf-backend-util"
      image_tag: "latest"
      slot: "production"
    secrets:
      AZURE_CLIENT_ID: ${{ secrets.AZURE_CLIENT_ID }}
      AZURE_TENANT_ID: ${{ secrets.AZURE_TENANT_ID }}
      AZURE_SUBSCRIPTION_ID: ${{ secrets.AZURE_SUBSCRIPTION_ID }}
